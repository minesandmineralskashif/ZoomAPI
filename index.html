<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Zoom Meeting Control</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>Zoom Meeting Portal</h1>

    <!-- Auth Buttons -->
    <div>
      <h2>Authenticate Zoom</h2>
      <a href="/zoom/auth/A">
        <button>Login with Zoom (Branch A)</button>
      </a>
      <a href="/zoom/auth/B">
        <button>Login with Zoom (Branch B)</button>
      </a>
    </div>

    <!-- Instant Meeting -->
    <div>
      <h2>Start Instant Meeting</h2>
      <button onclick="startMeeting('A')">Start for Branch A</button>
      <button onclick="startMeeting('B')">Start for Branch B</button>
    </div>

    <!-- Scheduled Meeting -->
    <div>
      <h2>Schedule a Meeting</h2>
      <a href="/schedule.html"><button>Schedule Meeting</button></a>
    </div>

    <script>
      async function startMeeting(branch) {
        const res = await fetch(`/create-meeting-${branch.toLowerCase()}`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({}),
        });

        const data = await res.json();
        if (data.join_url) {
          window.open(data.join_url, "_blank");
          await navigator.clipboard.writeText(data.join_url);

          alert("Join URL copied to clipboard!");
        } else {
          alert("Failed to create meeting.");
        }
      }
    </script>
  </body>
</html>
